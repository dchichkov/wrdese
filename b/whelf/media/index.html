<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
  <html>
  <head> <title>Example Style Settings</title> </head>

<!-- link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/cupertino/jquery-ui.css" type="text/css"/-->

<style type="text/css" title="currentStyle">
  @import "m/datatables/media/css/demo_table_jui.css";
  @import "http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/ui-lightness/jquery-ui.css";
  table td {white-space: nowrap;}
</style>

<script type="text/javascript" language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" language="javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
<script type="text/javascript" language="javascript" src="m/datatables/media/js/jquery.dataTables.js"></script>
<script type="text/javascript" language="javascript" src="m/js/jquery.timeFormat.js"></script>
<script type="text/javascript" language="javascript" src="m/js/jquery.cookie.js"></script>
<script type="text/javascript" language="javascript" src="m/js/jquery.Guid.js"></script>

<script type="text/javascript" charset="utf-8">
	var t, tid;
	
	function ellipsis(text, n) {
    if(text.length>n)
        return text.substring(0,n)+"...";
    else
        return text;	
	}

    function checkTrust()
    {
        tid = $.cookie('tid_cookie')
        if(tid)
        {
            $.get("s/tid", function(data){
                alert( "Your ip: " + data.ip);
            });
        }

        // $.cookie('tid_cookie', 'the_value'); // set cookie
        // $.cookie('tid_cookie', 'the_value', { expires: 7 }); // set cookie with an expiration date seven days in the future
        // $.cookie('the_cookie', '', { expires: -1 }); // delete cookie

        var $dialog = $('<div></div>')
            .html('Establishing connection...<br>' + jQuery.Guid.New())
            .dialog({title: 'Welcome.'});
        
         $.get("s/ip", function(data){
            alert( "Your ip: " + data.ip);
        });

    }


  $(document).ready(function() {
    checkTrust();

  	t = $('#table_here').dataTable({
		
		"fnRowCallback": function( nRow, aData, iDisplayIndex ) {
                            var $cell=$('td:eq(0)', nRow);
                            $cell.text( $.timeFormat($cell.text()) );

							
                            var $cell=$('td:eq(1)', nRow);
							if($cell.text() < -5) $cell.css({fontWeight:"bold", color:"#FF0000"}); 
							else if($cell.text() < 0) $cell.css("color", "#FF0000");
							else if($cell.text() > 100) $cell.css("color", "#348017");
						
							
                            var $cell=$('td:eq(4)', nRow);
                            $cell.text(ellipsis($cell.text(),30));

							
                            var $cell=$('td:eq(5)', nRow);
							page = $cell.text()
                            $cell.text(ellipsis($cell.text(),30));
							
                            var $cell=$('td:eq(3)', nRow);
                            $cell.html('<a href="' + $cell.text() + ' " target="_blank">diff...</a>');
							$cell.attr("alt", page)
							$cell.click(function() {$.post("s/c", $(this).attr("alt"));});
                            return nRow;
                    },
        "bJQueryUI": true,
        // "sPaginationType": "full_numbers",
        "bProcessing": false,
        "bServerSide": true,
        "sAjaxSource": "s/w",
        "fnServerData": function (sSource, aoData, fnCallback) {
            $.ajax ( {
              "dataType": 'json',
              "type": "POST",
              "url": sSource,
              "data": aoData,
              "success": fnCallback
            } );
         }
     } );
	 t.fnDraw();
	 window.setInterval(function() { t.fnDraw();}, 2000);

  } );
</script>


<body>  
	<div>
	<table cellspacing="0" border="0" class="display" id="table_here">
	        <thead>
	                <tr>
	                        <th width="10%">Time</th>
	                        <th width="5%">Trust</th>
	                        <th width="3%">Views</th>
	                        <th width="3%">Url</th>
	                        <th width="10%">User</th>
	                        <th width="20%">Page</th>
	                        <th width="50%">Summary</th>
	                </tr>
	        </thead>
	        <tbody>
	        </tbody>
	</table>
	</div>
</body>
</html>
